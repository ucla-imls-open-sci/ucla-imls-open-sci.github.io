---
// Status-specific banners for lesson pages
// Displays appropriate messaging based on lesson development stage

interface Props {
  status: string;
  isAdopted?: boolean;
  statusNote?: string;
}

const { status, isAdopted = false, statusNote = '' } = Astro.props;
const s = status?.toLowerCase() || '';

// Determine which banner to show
const isAlpha = s.includes('alpha') && !s.includes('pre');
const isBeta = s.includes('beta');
const isPreAlpha = s.includes('pre-alpha') || s.includes('pre alpha');
const isStable = s.includes('stable') || s.includes('mature');

// Don't show banner for external resources or if no clear status
const showBanner = !isStable && (isAlpha || isBeta || isPreAlpha);
---

{showBanner && (
  <section class={`lesson-status-banner ${isAlpha ? 'banner-alpha' : isBeta ? 'banner-beta' : 'banner-pre-alpha'}`}>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="banner-content">
            {isAlpha && (
              <>
                <div class="banner-icon">ðŸŸ¡</div>
                <h3 class="banner-title">This Lesson is Ready for External Piloting!</h3>
                <p class="banner-text">
                  The authors have taught this lesson and refined it based on feedback.
                  We're now looking for <strong>instructors to test it in new contexts and communities</strong>.
                </p>
                <div class="banner-details">
                  <div class="detail-section">
                    <h5>What's Involved:</h5>
                    <ul>
                      <li>Teach all or part of the lesson to your audience</li>
                      <li>Collect feedback from learners (we provide templates)</li>
                      <li>Share your experience via a brief report</li>
                    </ul>
                  </div>
                  <div class="detail-section">
                    <h5>What You Get:</h5>
                    <ul>
                      <li>Recognition as a contributor</li>
                      <li>Early access to cutting-edge curriculum</li>
                      <li>Join our community of practice</li>
                      <li>Professional development opportunity</li>
                    </ul>
                  </div>
                </div>
                <div class="banner-actions">
                  <a href="https://github.com/ucla-imls-open-sci/ucla-imls-open-sci.github.io/issues/new?template=pilot-interest.yml" class="btn btn-banner-primary" target="_blank">
                    <i class="fas fa-rocket mr-2"></i>I'm Interested in Piloting
                  </a>
                  <a href="https://github.com/ucla-imls-open-sci/ucla-imls-open-sci.github.io/blob/main/CONTRIBUTING.md#pilot-our-lessons" class="btn btn-banner-secondary" target="_blank">
                    <i class="fas fa-book mr-2"></i>View Pilot Guide
                  </a>
                </div>
              </>
            )}

            {isBeta && (
              <>
                <div class="banner-icon">ðŸ”µ</div>
                <h3 class="banner-title">This Lesson is Seeking More Pilots!</h3>
                <p class="banner-text">
                  This lesson has been piloted by external instructors and is working well.
                  We're seeking <strong>additional pilots to test it in diverse contexts</strong> and refine it further.
                </p>
                {statusNote && (
                  <div class="status-note">
                    <i class="fas fa-info-circle mr-2"></i>
                    {statusNote}
                  </div>
                )}
                <div class="banner-details single-column">
                  <div class="detail-section">
                    <h5>Why Pilot This Lesson?</h5>
                    <ul>
                      <li>Help validate the lesson across different teaching contexts</li>
                      <li>Contribute to final refinements before broader adoption</li>
                      <li>Get recognized as a contributor to the lesson</li>
                      <li>Shape open science education for librarians worldwide</li>
                    </ul>
                  </div>
                </div>
                <div class="banner-actions">
                  <a href="https://github.com/ucla-imls-open-sci/ucla-imls-open-sci.github.io/issues/new?template=pilot-interest.yml" class="btn btn-banner-primary" target="_blank">
                    <i class="fas fa-rocket mr-2"></i>I'm Interested in Piloting
                  </a>
                  <a href="https://github.com/ucla-imls-open-sci/ucla-imls-open-sci.github.io/blob/main/CONTRIBUTING.md#pilot-our-lessons" class="btn btn-banner-secondary" target="_blank">
                    <i class="fas fa-book mr-2"></i>View Pilot Guide
                  </a>
                </div>
              </>
            )}

            {isPreAlpha && (
              <>
                <div class="banner-icon">âšª</div>
                <h3 class="banner-title">This Lesson is in Active Development</h3>
                <p class="banner-text">
                  The authors are still developing this lesson. It's not ready for piloting yet.
                  Check back soon or watch the repository for updates!
                </p>
                {statusNote && (
                  <div class="status-note">
                    <i class="fas fa-info-circle mr-2"></i>
                    {statusNote}
                  </div>
                )}
                <div class="banner-actions">
                  <a href="#details" class="btn btn-banner-secondary">
                    <i class="fas fa-eye mr-2"></i>Preview Lesson Details
                  </a>
                </div>
              </>
            )}
          </div>
        </div>
      </div>
    </div>
  </section>
)}

{isAdopted && !isBeta && (
  <section class="lesson-status-banner banner-adopted">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="banner-content">
            <div class="banner-icon">âœ…</div>
            <h3 class="banner-title">This Lesson is Ready to Teach!</h3>
            <p class="banner-text">
              This lesson has been extensively tested and <strong>adopted by Library Carpentry</strong>.
              It's ready for general teaching. Feedback and contributions are still welcome.
            </p>
            <div class="banner-actions">
              <a href="#details" class="btn btn-banner-primary">
                <i class="fas fa-play-circle mr-2"></i>Start Teaching
              </a>
              <a href="https://github.com/ucla-imls-open-sci/ucla-imls-open-sci.github.io/issues/new" class="btn btn-banner-secondary" target="_blank">
                <i class="fas fa-comment mr-2"></i>Share Feedback
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
)}

<style>
.lesson-status-banner {
  padding: 2.5rem 0;
  margin-bottom: 2rem;
  border-top: 4px solid;
  border-bottom: 4px solid;
}

.banner-alpha {
  background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
  border-color: #ffc107;
}

.banner-beta {
  background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%);
  border-color: #0dcaf0;
}

.banner-pre-alpha {
  background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
  border-color: #6c757d;
}

.banner-adopted {
  background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
  border-color: #198754;
}

.banner-content {
  text-align: center;
  padding: 1.5rem;
  background: rgba(255, 255, 255, 0.8);
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.banner-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  line-height: 1;
}

.banner-title {
  font-size: 1.75rem;
  font-weight: 700;
  color: #212529;
  margin-bottom: 1rem;
}

.banner-text {
  font-size: 1.1rem;
  color: #495057;
  line-height: 1.6;
  margin-bottom: 1.5rem;
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
}

.status-note {
  background: rgba(255, 255, 255, 0.9);
  border-left: 4px solid #0dcaf0;
  padding: 1rem 1.5rem;
  margin: 1.5rem auto;
  max-width: 700px;
  border-radius: 4px;
  text-align: left;
  font-size: 0.95rem;
  color: #495057;
}

.banner-details {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  margin: 2rem 0;
  text-align: left;
}

.banner-details.single-column {
  grid-template-columns: 1fr;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.detail-section h5 {
  font-size: 1.1rem;
  font-weight: 600;
  color: #212529;
  margin-bottom: 0.75rem;
}

.detail-section ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.detail-section li {
  padding: 0.5rem 0;
  padding-left: 1.5rem;
  position: relative;
  color: #495057;
  line-height: 1.5;
}

.detail-section li::before {
  content: "âœ“";
  position: absolute;
  left: 0;
  color: #198754;
  font-weight: bold;
}

.banner-actions {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 1.5rem;
  flex-wrap: wrap;
}

.btn-banner-primary {
  background-color: #ffc107;
  border: 2px solid #ffc107;
  color: #000;
  font-weight: 600;
  padding: 0.875rem 2rem;
  border-radius: 50px;
  text-decoration: none;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  font-size: 1.05rem;
}

.btn-banner-primary:hover {
  background-color: #ffcd39;
  border-color: #ffcd39;
  color: #000;
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(255, 193, 7, 0.4);
  text-decoration: none;
}

.btn-banner-secondary {
  background-color: transparent;
  border: 2px solid #6c757d;
  color: #6c757d;
  font-weight: 600;
  padding: 0.875rem 2rem;
  border-radius: 50px;
  text-decoration: none;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  font-size: 1.05rem;
}

.btn-banner-secondary:hover {
  background-color: #6c757d;
  color: #fff;
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(108, 117, 125, 0.3);
  text-decoration: none;
}

/* Beta specific button color */
.banner-beta .btn-banner-secondary {
  border-color: #0dcaf0;
  color: #0dcaf0;
}

.banner-beta .btn-banner-secondary:hover {
  background-color: #0dcaf0;
  color: #000;
}

/* Responsive */
@media (max-width: 768px) {
  .lesson-status-banner {
    padding: 1.5rem 0;
  }

  .banner-icon {
    font-size: 2.5rem;
  }

  .banner-title {
    font-size: 1.4rem;
  }

  .banner-text {
    font-size: 1rem;
  }

  .banner-details {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }

  .banner-actions {
    flex-direction: column;
    width: 100%;
  }

  .btn-banner-primary,
  .btn-banner-secondary {
    width: 100%;
    justify-content: center;
  }
}
</style>
